\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}
\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,
colorlinks=true,
linkcolor=red,
citecolor=blue,
filecolor=magenta,
urlcolor=cyan
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}
\author{\authname}
\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}
\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Nov 13, 2025 & 1.0 & Initial MIS including modules M1–M10, M18–M19\\
\bottomrule
\end{tabularx}

\newpage
\section{Symbols, Abbreviations and Acronyms}
See SRS Documentation at \wss{project URL}

\newpage
\tableofcontents
\newpage
\pagenumbering{arabic}

\section{Introduction}
This document specifies the module interfaces for \progname{}, covering all backend
modules responsible for import, voxelization, serialization, model management, history,
tracking, and export. It complements the SRS and Module Guide and maintains
consistency with the decomposition hierarchy defined in the MG.

\section{Notation}
Mathematical notation follows \citet{HoffmanAndStrooper1995}. Derived data types include
sequences, strings, and tuples. Functions are described by input and output types.

\section{Module Decomposition}
\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule
Hardware-Hiding & ~\\
\midrule
\multirow{7}{0.3\textwidth}{Behaviour-Hiding} & Input Interpreter (M1)\\
& Voxel Slicing (M2)\\
& Serialization Manager (M5)\\
& Model Manager (M8)\\
& History Manager (M9)\\
& Voxel Tracking (M10)\\
\midrule
\multirow{3}{0.3\textwidth}{Software Decision} & Database Handler (M18)\\
& Export Structure (M19)\\
\bottomrule
\end{tabular}
\caption{Module Hierarchy}
\end{table}

\newpage
%=========================================================
\section{MIS of Input Interpreter Module (M1)} \label{M1}
\subsection{Module}
Parses and interprets input files (STL or project data) and converts them into
a unified internal representation.
\subsection{Uses}
Voxel Slicing (M2), Serialization Manager (M5), Error Handler (M14)
\subsection{Syntax}
\subsubsection{Exported Access Programs}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
parseFile & filePath: string & IntermediateModel & ImportFormatError\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
\subsubsection{State Variables} None
\subsubsection{Environment Variables} Accesses local file system
\subsubsection{Assumptions} File path is valid and supported
\subsubsection{Access Routine Semantics}
\noindent parseFile(filePath):
\begin{itemize}
\item transition: Reads and parses file, constructing internal structure.
\item output: Returns IntermediateModel with geometry/metadata.
\item exception: Raises ImportFormatError for corrupted or unsupported files.
\end{itemize}
\subsubsection{Local Functions}
detectFileType(), parseSTL(), loadProject(), normalizeModel()

%=========================================================
\newpage
\section{MIS of Voxel Slicing Module (M2)} \label{M2}
\subsection{Module}
Converts 3D geometric or mesh data into a layered voxel grid representation.
\subsection{Uses}
Input Interpreter (M1), Model Manager (M8)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
sliceModel & IntermediateModel & VoxelGrid & SliceError\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
\subsubsection{State Variables} None
\subsubsection{Environment Variables} None
\subsubsection{Access Routine Semantics}
sliceModel(model):
\begin{itemize}
\item transition: Converts geometric data into voxel layers.
\item output: Returns structured voxel grid with layer index.
\item exception: SliceError if voxel dimensions exceed limits.
\end{itemize}
\subsubsection{Local Functions}
generateLayers(), computeBounds(), mapFacetsToVoxels()

%=========================================================
\newpage
\section{MIS of Serialization Manager Module (M5)} \label{M5}
\subsection{Module}
Handles serialization and deserialization of voxel models and project data.
\subsection{Uses}
Database Handler (M18), Model Manager (M8)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
serializeModel & Model & EncodedData & WriteError\\
deserializeModel & EncodedData & Model & ReadError\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
\subsubsection{State Variables} None
\subsubsection{Environment Variables} Reads/writes to storage via Database Handler
\subsubsection{Access Routine Semantics}
\noindent serializeModel(M):
\begin{itemize}
\item output: EncodedData in JSON/binary format.
\end{itemize}
\noindent deserializeModel(D):
\begin{itemize}
\item output: Reconstructed Model structure.
\end{itemize}

%=========================================================
\newpage
\section{MIS of Model Manager Module (M8)} \label{M8}
\subsection{Module}
Maintains the internal voxel model, tracks metadata, and exposes APIs to modify
model layers, voxels, and materials.
\subsection{Uses}
Serialization Manager (M5), History Manager (M9)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
addVoxel & position: tuple & None & InvalidPosition\\
removeVoxel & position: tuple & None & InvalidPosition\\
getVoxel & position: tuple & Voxel & NotFound\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
State variable: currentModel : Model\\
addVoxel(p): Adds voxel at p\\
removeVoxel(p): Removes voxel from grid\\
getVoxel(p): Retrieves voxel properties

%=========================================================
\newpage
\section{MIS of History Manager Module (M9)} \label{M9}
\subsection{Module}
Manages undo/redo operations by recording and restoring model states.
\subsection{Uses}
Model Manager (M8)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
undo & None & Model & None\\
redo & None & Model & None\\
recordState & Model & None & None\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
\subsubsection{State Variables}
historyStack: sequence of Model\\
index: integer pointer
\subsubsection{Access Routine Semantics}
undo(): index--, return previous Model\\
redo(): index++, return next Model\\
recordState(M): push new Model state

%=========================================================
\newpage
\section{MIS of Voxel Tracking Module (M10)} \label{M10}
\subsection{Module}
Provides search and filtering operations to identify voxels matching given
properties such as material, magnetization, or coordinates.
\subsection{Uses}
Model Manager (M8)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
trackVoxels & Predicate & Set<Voxel> & None\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
\subsubsection{Access Routine Semantics}
trackVoxels(\textit{predicate}):
\begin{itemize}
\item output: Returns set of voxels satisfying predicate conditions.
\end{itemize}

%=========================================================
\newpage
\section{MIS of Database Handler Module (M18)} \label{M18}
\subsection{Module}
Handles saving and loading of serialized project data between storage and
application logic.
\subsection{Uses}
Serialization Manager (M5)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
saveProject & EncodedData & None & WriteError\\
loadProject & ProjectID & EncodedData & ReadError\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
saveProject(D): Writes serialized data to persistent storage.\\
loadProject(ID): Retrieves and returns serialized data.

%=========================================================
\newpage
\section{MIS of Export Structure Module (M19)} \label{M19}
\subsection{Module}
Defines and validates the schema of exported files, ensuring consistency between
internal model data and output format.
\subsection{Uses}
Database Handler (M18), Serialization Manager (M5)
\subsection{Syntax}
\begin{center}
\begin{tabular}{p{3cm}p{4cm}p{4cm}p{2cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions}\\
\midrule
validateExport & Model & Boolean & SchemaError\\
generateExport & Model & ExportFile & WriteError\\
\bottomrule
\end{tabular}
\end{center}
\subsection{Semantics}
validateExport(M): Returns true if model matches export schema.\\
generateExport(M): Produces structured export file containing voxel, layer, and
magnetization data.

%=========================================================
\newpage
\bibliographystyle{plainnat}
\bibliography{../../../refs/References}
\end{document}
