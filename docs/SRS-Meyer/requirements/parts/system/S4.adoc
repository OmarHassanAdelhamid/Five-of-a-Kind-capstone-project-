[#s4,reftext=S.4]
=== (S.4) Detailed usage scenarios

ifdef::env-draft[]
TIP: _Examples of interaction between the environment (or human users) and the system, expressed as user stories. Such scenarios are not by themselves a substitute for precise descriptions of functionality (<<s3>>), but provide an important complement by specifying cases that these behavior descriptions must support; they also serve as a basis for developing test cases. The scenarios most relevant for stakeholders are given in chapter <<g5>> in the Goals book, at a general level, as use cases; in contrast, <<s4>> can refer to system components and functionality (from other chapters of the System book) as well as special and erroneous cases, and introduce more specific scenarios._  <<BM22>>
endif::[]

==== (S.4.1) Import and Voxelize CAD Model

* **Use case**: UC1, UC2
* **Primary Actor**: Researcher/Engineer
* **Supporting Actors**: System
* **Precondition**: User has a completed 3D CAD model in STL/OBJ format and the voxel magnetization system is running on their desktop/laptop.
* **Trigger**: User wants to begin the magnetization assignment process for a new 3D printed object.
* **Main Success Scenario**:

    - 1. User opens the voxel magnetization system application.
    - 2. User navigates to the "Import Model" section and selects their CAD file (STL/OBJ format).
    - 3. System validates the file format and displays file information (dimensions, triangle count, etc.).
    - 4. User confirms the import and system begins voxelization process.
    - 5. System converts the mesh to a voxel grid with fixed dimensions.
    - 6. System displays the voxelized model in the 3D viewer with layer navigation controls.
    - 7. System shows total number of voxels and layers in the model.
    - 8. User can now begin layer-by-layer magnetization assignment.
* **Secondary Scenarios**:

    - 3.1. File format is invalid or corrupted - System displays error message and requests valid file.
    - 4.1. File is too large for available memory - System suggests reducing model complexity or increasing system resources.
    - 5.1. Voxelization fails due to mesh issues - System provides diagnostic information and suggests mesh repair.
    - 6.1. System performance is slow during rendering - System provides optimization options or simplified view modes.
* **Success Postcondition** : CAD model is successfully converted to voxel grid and ready for magnetization assignment.

This scenario is important as it establishes the foundation for the entire project. The ability to reliably import and convert a CAD model to voxels is critical for users who need to work with existing designs rather than starting from scratch.

==== (S.4.2) Assign Magnetization to Voxel Layer

* **Use case**: UC2, UC3
* **Primary Actor**: Researcher/Engineer
* **Supporting Actors**: System
* **Precondition**: CAD model has been successfully imported and voxelized, user is viewing a specific layer in the 3D viewer.
* **Trigger**: User wants to assign magnetization directions to specific voxels within the current layer.
* **Main Success Scenario**:

    - 1. User navigates to a specific layer using the layer slider (bottom to top).
    - 2. System displays the 2D cross-section of voxels for the selected layer.
    - 3. User selects individual voxels or multiple voxels using click/drag selection.
    - 4. System highlights selected voxels and shows current magnetization state.
    - 5. User opens the magnetization direction panel and chooses a magnetization direction for that set of chosen voxels.
    - 6. User applies the selected magnetization direction to the chosen voxels.
    - 7. System updates the display to show the new magnetization assignments with color coding.
    - 8. System saves the changes to the project file automatically.
    - 9. User can navigate to other layers and repeat the process.
* **Secondary Scenarios**:

    - 3.1. User accidentally selects wrong voxels - System offers an 'Undo' option to revert the selection.
    - 4.1. User wants to clear magnetization from selected voxels - System provides a 'Clear' option within the magnetization controls.
    - 5.1. User needs custom magnetization direction - System presents an option for advanced users to input a custom vector manually.
    - 6.1. System performance degrades with many selected voxels - System displays error message and asks users to select fewer voxels
    - 7.1. User wants to copy magnetization pattern to other layers - System provides copy/paste functionality.
* **Success Postcondition**: Selected voxels in the current layer have been assigned the desired magnetization directions.

This scenario is improtant because it provides the core functionality of this system, which is allowing users to precisly control the magnetization at the voxel level. The layer by layer approach allows users to assign magnetization patterns while also maintaining a 3D view of the structure. The ability to select multiple voxels and apply consistent magnetization directions significantly reduces the time required compared to manual voxel-by-voxel assignment.

==== (S.4.3) Edit and Modify Existing Magnetization

* **Use case**: UC3
* **Primary Actor**: Researcher/Engineer
* **Supporting Actors**: System
* **Precondition**: User has already assigned magnetization to some voxels and wants to make changes without restarting the entire process.
* **Trigger**: User discovers an error in magnetization assignment or wants to optimize the magnetization pattern.
* **Main Success Scenario**:

    - 1. User navigates to the layer containing voxels that need modification.
    - 2. System displays the current magnetization state with color-coded voxels.
    - 3. User selects the voxels that need to be changed (individual or multiple selection).
    - 4. System visually indicates the current magnetization direction of the selected voxels and presents the magnetization direction panel.
    - 5. User selects a new magnetization direction from the presented direction panel.
    - 6. System applies the new magnetization to the selected voxels and updates the visual display accordingly.
    - 7. System automatically saves the changes and maintains edit history.
    - 8. User continues with other modifications as needed.
* **Secondary Scenarios**:

    - 3.1. User wants to select all voxels in current layer - System provides "Select All" option.
    - 4.1. User wants to find voxels with specific magnetization - System provides a visual tool to highlight voxels with the specified magnetization.
    - 5.1. User wants to apply same change to multiple layers - System provides copy/paste functionality.
    - 6.1. System loses power during editing - System has auto-save functionality to prevent data loss.
* **Success Postcondition**: Magnetization assignments have been successfully modified without losing other work.

This scenario is important because it addresses the critical need for iterative design refinement. users often need to make adjustments to their magnetization patterns based on simulation results or design requirements. The ability to edit existing assignments without restarting the entire process saves significant time and reduces frustration, making the system practical for real-world research workflows.

==== (S.4.4) Export Magnetization Data for 3D Printing

* **Use case**: UC4
* **Primary Actor**: Researcher/Engineer
* **Supporting Actors**: Lab Operator, System
* **Precondition**: User has completed magnetization assignment for all layers and is ready to prepare the data for 3D printing.
* **Trigger**: User wants to export the voxel magnetization data to be used by the custom 3D printer software.
* **Main Success Scenario**:

    - 1. User navigates to the "Export" section of the application.
    - 2. System displays export options and file format information.
    - 3. User reviews the magnetization summary (total voxels, layers, magnetization distribution).
    - 4. User selects to designated location for the lab operator to save the file.
    - 5. System validates all voxel data and checks for completeness.
    - 6. System generates the export file containing per-voxel location, layer, and magnetization direction metadata.
    - 7. System displays export confirmation with file size and location information.
    - 8. Lab operator receives the file and can load it into the custom printer software.
* **Secondary Scenarios**:

    - 3.1. System detects incomplete magnetization data - System highlights missing areas and prevents export.
    - 5.1. Export file is too large for available storage - System displays detailed error about storage space
    - 6.1. System encounters errors during export - System provides detailed error log and recovery options.
    - 7.1. Lab operator reports issues with exported file - System provides validation tools and format verification.
* **Success Postcondition**: Complete voxel magnetization data has been exported in the correct format for the 3D printer.

This scenario is important because it represents the last step in the workflow, ensuring that the users can take what they have been working on and successfully transfer it to a physical printing process. The export functionality must be reliable and produce a file that is compatible with the existing  printing pipeline, while maintaining the magnetization data (CSV) throughout the transition.

==== (S.4.5) Validate and Review Magnetization Design

* **Use case**: UC1, UC5
* **Primary Actor**: Researcher/Engineer
* **Supporting Actors**: Supervisor, System
* **Precondition**: User has completed magnetization assignment and wants to validate the design before export and printing.
* **Trigger**: User wants to review the complete magnetization pattern and ensure it meets the their needs.
* **Main Success Scenario**:

    - 1. System displays the complete 3D model with magnetization visualization.
    - 2. User can rotate, zoom, and examine the model from different angles.
    - 3. System provides layer-by-layer navigation to review specific sections.
    - 4. User can filter the view to show only voxels with specific magnetization directions.
    - 5. User can generate a metadata summary(CSV) of the magnetization pattern.
* **Secondary Scenarios**:

    - 5.1. Supervisor requests changes after review - User can return to editing mode.
* **Success Postcondition**: User has thoroughly reviewed the magnetization design and is confident it meets their needs.

This scenario is important because it ensures quality and validation before moving on to the final step of exporting the file. This prevents the expensive and time-consuming 3D printing process on a file that is not what's needed. 